/*! SPA-Cinemas 2014-11-14 */
function add_cinema_to_list(a,b){var c=document.getElementById("cinema_list"),d=document.createElement("li"),e=document.createElement("strong"),f=document.createElement("small");e.appendChild(document.createTextNode(a)),f.appendChild(document.createTextNode(b)),d.appendChild(e),d.appendChild(f),c.appendChild(d)}function check_session(){if(user_session=storage_cinemas.get("Session"),null===user_session){for(var a="";null===a||a.length<=0;)a=prompt();storage_cinemas.add("Session",a),document.getElementById("session").innerHTML=a,user_session=storage_cinemas.get("Session")}else user_session=storage_cinemas.get("Session");if(document.getElementById("session").innerHTML=JSON.parse(user_session)[0].name,cinemas_session=storage_cinemas.get("Cinemas"),null!==cinemas_session){cinema_list=JSON.parse(cinemas_session);for(var b=0,d=cinema_list.length;d>b;b++)c=cinema_list[b],add_cinema_to_list(c.name,c.street)}}function initialize(){var a={zoom:8,center:new google.maps.LatLng(-34.397,150.644)};map=new google.maps.Map(document.getElementById("map_canvas"),a)}function push_pins_marker(a,b){new google.maps.Marker({position:new google.maps.LatLng(a,b),map:map})}document.getElementById("add_cinema_btn").addEventListener("click",function(a){a.preventDefault(),a.stopPropagation();var b=["name_cinema","street_cinema","latitude_cinema","longitude_cinema"];obj_cinemas={};for(var c=0,d=b.length;d>c;c++)obj_cinemas[b[c]]=document.querySelector("input[name="+b[c]+"]").value;storage_cinemas.add("Cinemas",obj_cinemas.name_cinema,obj_cinemas.street_cinema,obj_cinemas.latitude_cinema,obj_cinemas.longitude_cinema),add_cinema_to_list(obj_cinemas.name_cinema,obj_cinemas.street_cinema)}),document.getElementsByTagName("li")[0].addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),cinema_name=document.getElementsByTagName("li:target > strong").value,cinema_target_array=storage_cinemas.search("Cinemas","name",cinema_name),cinema_target=cinema_target_array[0],push_pins_marker(cinema_target.latitude,cinema_target.longitude);var b=["name_cinema","street_cinema","latitude_cinema","longitude_cinema"];obj_cinemas={};for(var c=0,d=b.length;d>c;c++)obj_cinemas[b[c]]=document.querySelector("input[name="+b[c]+"]").value;storage_cinemas.add("Cinemas",obj_cinemas.name_cinema,obj_cinemas.street_cinema,obj_cinemas.latitude_cinema,obj_cinemas.longitude_cinema),add_cinema_to_list(obj_cinemas.name_cinema,obj_cinemas.street_cinema)});var storage_cinemas=function(){return _add=function(a,b,c,d,e){var f=JSON.parse(_get(a))||[];"Cinemas"===a?f.push({name:b,street:c,latitude:d,longitude:e}):f=[{name:b}],f=JSON.stringify(f),window.localStorage.setItem(a,f)},_get=function(a){return window.localStorage.getItem(a)},_show=function(a){film=_get(a),film_json=JSON.parse(film),console.log(film_json)},_search=function(a,b,c){for(film_list=_get(a),array_film_list=JSON.parse(film_list),found=[],i=0,len=array_film_list.length;len>i;i++)array_film_list[i][b]===c&&found.push(array_film_list[i]);return found},_delete=function(a,b,c){null!==(film_list=_get(a))&&0!==(array_film_list=JSON.parse(film_list)).length&&(array_film_list_after_delete=_delete_films_by(b,c,"erase"),window.localStorage.setItem(a,JSON.stringify(array_film_list_after_delete)))},_delete_films_by=function(a,b,c){for(coincidences=[],differences=[],result=[],i=0,len=array_film_list.length;len>i;i++)film=array_film_list[i],film[a]===b?coincidences.push(film):differences.push(film),result="erase"===c?differences:coincidences;return result},{version:"1.0.0",add:_add,get:_get,show:_show,search:_search,"delete":_delete}}(),map;google.maps.event.addDomListener(window,"load",initialize);